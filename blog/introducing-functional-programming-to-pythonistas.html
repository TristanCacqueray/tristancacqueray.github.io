<!DOCTYPE html>
<!-- TODO: Main navigation links (Home, index, tags, ...) --><!-- DoNotFormat -->
<!-- DoNotFormat -->

<html lang='en'>

<head>
  <meta charset='UTF-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <title>
    Introducing Functional Programming to Pythonistas – Tristan's Zettelkasten
  </title>
  
    
      <meta property='og:description' content='This year, I continued my journey through computer science by learning functional programming. I started using functional programming (FP) through emacs lisp, then scheme with the SICP book, until I discovered Haskell, which is arguably the best language to learn FP concepts. There I discovered software designs that provide elegant solutions to some of the problems my team and I are facing.' />
      <meta property='og:site_name' content="Tristan's Zettelkasten" />
      <meta property='og:image' content />
      <meta property='og:type' content='website' />
      <meta property='og:title' content='Introducing Functional Programming to Pythonistas' />
    
    
      <base href='/' />
      <link href='static/favicon.jpeg' rel='icon' />
    
    <!-- highlight.js -->
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/hybrid.min.css' />
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js'></script>
<!-- Include languages that Emanote itself uses -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/haskell.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/nix.min.js'></script>
<script>hljs.highlightAll();</script>



<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/lisp.min.js'></script>

<!-- mermaid.js --><script type='module'>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: false });
  mermaid.init(undefined,document.querySelectorAll(".mermaid"));
</script>

<script>
window.MathJax = {
  startup: {
    ready: () => {MathJax.startup.defaultReady();}
  }
};
</script>
<script async id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'></script>

  
  
  <link href='tailwind.css?instanceId=2e5d4d69-31db-49ee-8771-50cd12fa7287' rel='stylesheet' type='text/css' />

  <style>
    /* Heist error element */
    strong.error {
      color: lightcoral;
      font-size: 90%;
      font-family: monospace;
    }

    /* External link icon */
    a[data-linkicon=""]::after {
      content: ""
    }

    a[data-linkicon=none]::after {
      content: ""
    }

    a[data-linkicon="external"]::after {
      content: url('data:image/svg+xml,\
      <svg xmlns="http://www.w3.org/2000/svg" height="0.7em" viewBox="0 0 20 20"> \
        <g style="stroke:gray;stroke-width:1"> \
          <line x1="5" y1="5" x2="5" y2="14" /> \
          <line x1="14" y1="9" x2="14" y2="14" /> \
          <line x1="5" y1="14" x2="14" y2="14" /> \
          <line x1="5" y1="5" x2="9" y2="5"  /> \
          <line x1="10" y1="2" x2="17" y2="2"  /> \
          <line x1="17" y1="2" x2="17" y2="9" /> \
          <line x1="10" y1="9" x2="17" y2="2" style="stroke-width:1.0" /> \
        </g> \
      </svg>');
    }

    a[data-linkicon="external"][href^="mailto:"]::after {
      content: url('data:image/svg+xml,\
        <svg \
          xmlns="http://www.w3.org/2000/svg" \
          height="0.7em" \
          fill="none" \
          viewBox="0 0 24 24" \
          stroke="gray" \
          stroke-width="2"> \
          <path \
            stroke-linecap="round" \
            stroke-linejoin="round" \
            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /> \
        </svg>');
    }
  </style>
  <!-- What goes in this file will appear on near the end of <head>--><link rel='preload' href='_emanote-static/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf' as='font' type='font/ttf' crossorigin />

<style>
  @font-face {
    font-family: 'WorkSans';
    /* FIXME: This ought to be: ${ema:emanoteStaticLayerUrl}/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf */
    src: url(_emanote-static/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf) format("truetype");
    font-display: swap;
  }

  body {
    font-family: 'WorkSans', sans-serif;
    font-variation-settings: 'wght' 350;
  }

  a.mavenLinkBold {
    font-variation-settings: 'wght' 400;
  }

  strong {
    font-variation-settings: 'wght' 500;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  header,
  .header-font {
    font-family: 'WorkSans', sans-serif;
  }

  h1 {
    font-variation-settings: 'wght' 500;
  }

  h2 {
    font-variation-settings: 'wght' 400;
  }

  h3 {
    font-variation-settings: 'wght' 300;
  }
</style>


  
    <link rel='stylesheet' href='_emanote-static/inverted-tree.css' />
  
  <link rel='stylesheet' href='_emanote-static/stork/flat.css' />
<!-- Custom Stork-search styling for Emanote -->
<style>
  #stork-search-container {
    z-index: 1000;
    background-color: rgb(15 23 42/.8);
  }

  .stork-overflow-hidden-important {
    overflow: hidden !important;
  }
</style>


<script src='_emanote-static/stork/stork.js'></script>

  
    <script id='emanote-stork' data-emanote-base-url='/'>
      window.emanote = {};
      window.emanote.stork = {
        searchShown: false,
        indexIsStale: false,
        toggleSearch: function () {
          window.emanote.stork.refreshIndex();
          document.getElementById('stork-search-container').classList.toggle('hidden');
          window.emanote.stork.searchShown = document.body.classList.toggle('stork-overflow-hidden-important');
          if (window.emanote.stork.searchShown) {
            document.getElementById('stork-search-input').focus();
          }
        },
        clearSearch: function () {
          document.getElementById('stork-search-container').classList.add('hidden');
          document.body.classList.remove('stork-overflow-hidden-important');
          window.emanote.stork.searchShown = false;
        },

        getBaseUrl: function () {
          const baseUrl = document.getElementById("emanote-stork").getAttribute('data-emanote-base-url') || '/';
          return baseUrl;
        },

        registerIndex: function (options) {
          const indexName = 'emanote-search'; // used to match input[data-stork] attribute value
          const indexUrl = window.emanote.stork.getBaseUrl() + '-/stork.st';
          stork.register(
            indexName,
            indexUrl,
            options);
        },

        init: function () {
          if (document.readyState !== 'complete') {
            window.addEventListener('load', function () {
              stork.initialize(window.emanote.stork.getBaseUrl() + '_emanote-static/stork/stork.wasm');
              window.emanote.stork.registerIndex();
            });

            document.addEventListener('keydown', event => {
              if (window.emanote.stork.searchShown && event.key === 'Escape') {
                window.emanote.stork.clearSearch();
                event.preventDefault();
              } else if ((event.key == 'k' || event.key == 'K') && (event.ctrlKey || event.metaKey)) {
                window.emanote.stork.toggleSearch();
                event.preventDefault();
              }
            });
          } else {
            // This section is called during Ema's hot reload.
            // 
            // Mark the current index as stale, and refresh it *only when* the
            // user actually invokes search.
            // 
            // We do not refresh the index *right away*, as that will cause
            // memory leaks in the browser. See
            // https://github.com/srid/emanote/issues/411#issuecomment-1402056235
            console.log("stork: Marking index as stale");
            window.emanote.stork.markIndexAsStale();
          }
        },

        markIndexAsStale: function () {
          window.emanote.stork.indexIsStale = true;
        },

        refreshIndex: function () {
          if (window.emanote.stork.indexIsStale) {
            console.log("stork: Reloading index");
            window.emanote.stork.indexIsStale = false;
            // NOTE: This will leak memory. See the comment above.
            window.emanote.stork.registerIndex({ forceOverwrite: true });
          }
        }

      };

      window.emanote.stork.init();
    </script>
  

</head>

<!-- DoNotFormat -->



<!-- DoNotFormat -->

<body class='overflow-y-scroll bg-gray-400'>
  
    <div class='container mx-auto max-w-screen-lg'>
      <div class='mt-2 md:mt-4'>
        <!-- DoNotFormat -->
<!-- DoNotFormat -->

<nav id='uptree' class='flipped tree' style='transform-origin: 50%;'>
  <ul class='root'>
    <li>
      
        <ul>
          
            <li>

  <div class='text-gray-900 forest-link'>
    <a href='blog'>
      Blog
    </a>
  </div>

  
    <ul>
      
        <li>

  <div class='text-gray-900 forest-link'>
    <a href=''>
      Tristan de Cacqueray
    </a>
  </div>

  
</li>
      
    </ul>
  
</li>
          
        </ul>
      
    </li>
  </ul>
</nav>

        <div class='relative md:shadow-2xl md:mb-8'>

          <div class='absolute -top-6 right-1 md:right-0 flex flex-row items-center justify-center'>
            <a title='Search (Ctrl+K)' class='cursor-pointer' onclick='window.emanote.stork.toggleSearch()'>
              <svg xmlns='http://www.w3.org/2000/svg' style='width: 1rem;' class='hover:text-blue-700' f
 fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'>
  <path stroke-linecap='round' stroke-linejoin='round' d='M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'></path>
</svg>
            </a>
          </div>
          <div class='flex-1 w-full overflow-x-auto bg-white'>
            <main class='px-4 py-4'>
              <h1 class='flex items-end justify-center mb-4 p-3 bg-blue-100 text-5xl font-extrabold text-black rounded'>
  <a class='z-40 tracking-tighter '>
    Introducing Functional Programming to Pythonistas
  </a>
</h1>
              <article class='overflow-auto'>
  <!-- What goes in this file will appear on top of note body-->
  
    <p class='mb-3'>
      This year, I continued my journey through computer science by learning functional programming. I started using functional programming (FP) through emacs lisp, then scheme with the SICP book, until I discovered Haskell, which is arguably the best language to learn FP concepts. There I discovered software designs that provide elegant solutions to some of the problems my team and I are facing.
    </p>
  
    <p class='mb-3'>
      This post documents why I introduced FP to my team, and what strategies I used. But first, let’s define the FP paradigms.
    </p>
  <h2 id='functional-programming-paradigms' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Functional programming paradigms</h2>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          FP is a programming paradigm where programs are constructed by applying and composing functions.
        </li>
      
        <li>
          FP is declarative programming. Instead of using statements to change the program’s state, FP expresses the logic of a computation without describing its control flow.
        </li>
      
        <li>
          FP is built on proven general purpose theories such as lambda calculus and abstract algebra.
        </li>
      
        <li>
          FP enables a strong type system. While some FP languages like LISP do not feature such type systems, I am refering to FP languages using <code class='py-0.5 px-0.5 bg-gray-100'>System F</code> which enable a powerful and always correct types inference.
        </li>
      
    </ul>
  
    <p class='mb-3'>
      To learn more about these paradigms, I recommend Richard Feldman’s talk <a href='https://www.youtube.com/watch?v=6YbK8o9rZfI' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>The Next Paradigm Shift in Programming</a> and Gabriel Gonzales’s post <a href='http://www.haskellforall.com/2020/10/why-i-prefer-functional-programming.html' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Why I prefer FP</a>.
    </p>
  
    <p class='mb-3'>
      With that definition out of the way, the next section explains the advantages of FP paradigms.
    </p>
  <h2 id='reasons-to-use-functional-programming' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Reasons to use functional programming</h2>
    <p class='mb-3'>
      As Michael Snoyman explains in his <a href='https://www.youtube.com/watch?v=n7QETok5hYI' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Economic Argument for Functional Programming</a> talk, FP benefits include:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Reduce code review time.
        </li>
      
        <li>
          Consistent interface and reduced bug count by combining general purpose concepts.
        </li>
      
        <li>
          Remove classes of bugs entirely, reducing testing burden, QA can focus on higher impact bugs.
        </li>
      
        <li>
          Motivate development, leading to better staff retention and easier recruiting.
        </li>
      
    </ul>
  
    <p class='mb-3'>
      In particular there are three areas in which I am looking for solutions:
    </p>
  <h3 id='development-cycle' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Development cycle</h3>
    <p class='mb-3'>
      When we update our software we rely on extensive tests to check the code. These tests may take hours to complete, resulting in a long feedback loop. FP may provide a faster feedback loop to improve our productivity.
    </p>
  <h3 id='reusability' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Reusability</h3>
    <p class='mb-3'>
      When we integrate software to build services, we are often dealing with a complex stack of components that do not share or re-use common computations. For example, we have many independent TLS setup implementations. Such components rely on complex state management that is difficult to compose. FP provides effective tools to define and re-use the common computations.
    </p>
  <h3 id='system-operations' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>System operations</h3>
    <p class='mb-3'>
      When we operate software, we are often faced with runtime errors such as AttributeError or ReferenceError. For example, when we restart our CI scheduler, we may not be able to re-enqueue some changes when they are in an undefined state. This kind of issue is nasty because:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          The underlying bugs are hard to debug.
        </li>
      
        <li>
          Operating the software in production is stressful.
        </li>
      
        <li>
          Even though we spend a lot of time and energy to prevent those issues, they can still occur.
        </li>
      
    </ul>
  
    <p class='mb-3'>
      FP may result in lower bug counts to increase reliability.
    </p>
  
    <p class='mb-3'>
      However, learning FP has a significant cost of its own. The next section describes the strategies I used to introduce FP.
    </p>
  <h2 id='introducing-new-concepts' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing new concepts</h2>
    <p class='mb-3'>
      As my team works remotely, I proposed that we set a weekly online event to spend some time together. Without a specific goal, I meant to create a fun and relaxed space where we would collaborate outside of our day to day activities. We used a shared remote desktop environment so that the whole team would see and use the same tools.
    </p>
  
    <p class='mb-3'>
      This event is not dedicated to FP and each members can propose a subject. For example, we did a couple of sessions on using GraphQL. We used two different setups for one to two hours long session:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Code kata where the presenter would perform a software development exercise, explaining each concept along the way.
        </li>
      
        <li>
          Mob programming where the presenter would not drive the session. Instead, each participant would discuss and tell the presenter what to do.
        </li>
      
    </ul>
  
    <p class='mb-3'>
      Introducing new concepts is more difficult than I anticipated and I could have spend more time learning pedagogical techniques. In particular, there is a methodology where the presenter asks the attendees to generate questions (<a href='https://rightquestion.org/what-is-the-qft/' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>QFT</a>) which seems very effective. Finding the right question focus and raise interest takes a lot of time, even for professional educators.
    </p>
  
    <p class='mb-3'>
      The next sections describes each concept I introduced over the year.
    </p>
  <h2 id='introducing-function-composition' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing function composition</h2><h3 id='why' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Why</h3>
    <p class='mb-3'>
      Function composition is a mechanism that combines two functions. It is similar to object inheritance or object composition, but uses general purpose primitives that can be applied to a large set of problems. In particular, using function composition results in a more consistent interface compared to stateful objects.
    </p>
  <h3 id='how' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>How</h3>
    <p class='mb-3'>
      I shared Scott Wlaschin’s talk <a href='https://www.youtube.com/watch?v=WhEkBCWpDas' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>The Power of Composition</a> and looked for practical use-cases in our code base. For example, instead of writing this computation:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='python language-python'>for build in get_builds():
    if build.status == "NODE_FAILURE":
        continue
    print(build.log_url)
    ...</code></pre></div>
    <p class='mb-3'>
      I would suggest using this function composition:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='python language-python'>def completed_build(build):
    return build.status != "NODE_FAILURE"

def process(build):
    print(build.log_url)
    ...

list(map(process, filter(completed_build, get_builds())))</code></pre></div><h3 id='benefits' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Benefits</h3>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Break a computation in smaller pieces.
        </li>
      
        <li>
          Re-use common functions like <code class='py-0.5 px-0.5 bg-gray-100'>map</code> and <code class='py-0.5 px-0.5 bg-gray-100'>filter</code>.
        </li>
      
        <li>
          More declarative.
        </li>
      
    </ul>
  <h3 id='results' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Results</h3>
    <p class='mb-3'>
      Thinking in terms of function composition requires a change in habit, though I think this first concept is easy to introduce. A colleague even started to use <code class='py-0.5 px-0.5 bg-gray-100'>functools.reduce</code> when <code class='py-0.5 px-0.5 bg-gray-100'>map</code> was not enough.
    </p>
  
    <p class='mb-3'>
      I recommend Julien Danjou’s post <a href='https://julien.danjou.info/python-and-functional-programming/' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>An Introduction to Functional Programming with Python</a> as a follow-up.
    </p>
  
    <p class='mb-3'>
      To build up on function composition, I then introduced pure functions.
    </p>
  <h2 id='introducing-pure-function' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing pure function</h2><h3 id='why-1' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Why</h3>
    <p class='mb-3'>
      For a given input, a pure function always produces the same output. Thus, it is possible to truly study and understand such functions independently from others and they provide a solid building block for complex computations.
    </p>
  <h3 id='how-1' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>How</h3>
    <p class='mb-3'>
      I introduced Haskell for a small side project where we needed a new service to forward statsd metrics from UDP packets to two backends: telegraph and prometheus. We implemented the service in Python (<a href='https://softwarefactory-project.io/cgit/software-factory/sf-infra/tree/roles/udp-multiplexer/files/udp-multiplexer.py?id=e3eea281571325f1ccb282391613f0035adc121c' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>source</a>) and Haskell (<a href='https://softwarefactory-project.io/cgit/software-factory/sf-infra/tree/roles/udp-multiplexer/files/udp-multiplexer.hs?id=e3eea281571325f1ccb282391613f0035adc121c' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>source</a>) in pair programming.
    </p>
  
    <p class='mb-3'>
      Then I wrote a couple of blog posts about the language: <a href='https://fedoramagazine.org/getting-started-with-haskell-on-fedora/' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Getting Started with Haskell on Fedora</a> and <a href='https://www.softwarefactory-project.io/haskell-for-python-developers.html' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Haskell for python developpers</a>. I also demonstrated how we could use the language for other use-cases such as documentation management and software factory packages update.
    </p>
  <h3 id='benefits-1' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Benefits</h3>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Haskell features state-of-the-art programming paradigms.
        </li>
      
        <li>
          Small footprint, the service has been running continuously without any issues.
        </li>
      
        <li>
          More robust, the Haskell network library reports when UDP packets are not being delivered, something we were not able to achieve with Python.
        </li>
      
        <li>
          Short development cycle where most of the bugs are prevented by the compiler.
        </li>
      
    </ul>
  <h3 id='results-1' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Results</h3>
    <p class='mb-3'>
      There is a lot going on in Haskell and there is a steep learning curve. Learning Haskell is a significant investment and the project I used to introduce the language was too small to allow for the team to gain adequate experience using the language. Though new projects are a good opportunity to explore new languages.
    </p>
  <h2 id='introducing-monadic-function' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing monadic function</h2><h3 id='why-2' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Why</h3>
    <p class='mb-3'>
      As Graham Hutton states in the <a href='https://www.youtube.com/watch?v=t1e8gqXLbsU' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>What is a Monad?</a> computerphile video, Monad is one of the most important developments in programming languages in the last twenty-eight years.
    </p>
  <h3 id='how-2' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>How</h3>
    <p class='mb-3'>
      I introduced the concept through a code kata using the <a href='https://www.cs.nott.ac.uk/~pszgmh/monparsing.pdf' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Monadic Parser Combinators</a> paper to implement a RPM spec file parser. I went through the paper by re-implementing each functions in pure Python. Then I showed how the same concepts can be used for error handling and to manage side effects.
    </p>
  
    <p class='mb-3'>
      I also presented a couple of Python libraries such as <code class='py-0.5 px-0.5 bg-gray-100'>toolz</code> and <code class='py-0.5 px-0.5 bg-gray-100'>effect</code>.
    </p>
  <h3 id='benefits-2' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Benefits</h3>
    <p class='mb-3'>
      Monad is a general purpose building block that can be applied for many, if not all, computations. Combined with pure functions, monads enable a clean composition for effectful computations.
    </p>
  <h3 id='results-2' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Results</h3>
    <p class='mb-3'>
      Explaining this concept from the ground up is a difficult exercise and using an existing combinator library might have been a better strategy. Moreover, Python is not the most ergonomic language to write purely functional style code, resulting in non idiomatic implementations.
    </p>
  
    <p class='mb-3'>
      Even though pure monadic functions did not spark much joy for my team, there is still a lot to learn from FP. Thus, I switched gears to the more practical type system concept.
    </p>
  <h2 id='introducing-type-system-and-immutability' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing type system and immutability</h2><h3 id='why-3' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Why</h3>
    <blockquote class='py-0.5 px-4 mb-3 italic border-l-4 bg-gray-50 text-gray-600 border-gray-400 quote'>
      
    <p class='mb-3'>
      The fundamental purpose of a type system is to prevent the occurrence of execution errors during the running of a program.
    </p>
  
    <p class='mb-3'>
      – <span xmlhtmlRaw><cite></span>Luca Cardelli<span xmlhtmlRaw></cite></span>
    </p>
  
    </blockquote>
  <h3 id='how-3' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>How</h3>
    <p class='mb-3'>
      Since python version 3.6, we can add type annotations and use the <code class='py-0.5 px-0.5 bg-gray-100'>mypy</code> type checker. So instead of using such object:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='python language-python'>def get_build():
    return dict(status="SUCCESS", log_url="http://example")</code></pre></div>
    <p class='mb-3'>
      I would suggest to use a <code class='py-0.5 px-0.5 bg-gray-100'>dataclass</code>:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='python language-python'>@dataclass(frozen=True)
class Build:
    status: str
    log_url: str

def get_build() -&gt; Build:
    return Build("SUCCESS", "http://example")</code></pre></div>
    <p class='mb-3'>
      I performed a code kata on dataclass and wrote a <a href='https://www.softwarefactory-project.io/python-dataclasses.html' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>blog post</a>.
    </p>
  <h3 id='benefits-3' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Benefits</h3>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Type checker may prevent runtime errors.
        </li>
      
        <li>
          Re-usable, a library providing dataclass is safer to use.
        </li>
      
    </ul>
  <h3 id='results-3' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Results</h3>
    <p class='mb-3'>
      This was well received and the benefit of <code class='py-0.5 px-0.5 bg-gray-100'>mypy</code> is quite practical, but dataclasses are difficult to introduce in an existing code base. Thus, we were not able to benefit much from it.
    </p>
  <h2 id='introducing-strong-type-system' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing strong type system</h2><h3 id='why-4' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Why</h3>
    <p class='mb-3'>
      A strong type system provides stronger safety and definitely excludes certain classes of programming errors.
    </p>
  <h3 id='how-4' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>How</h3>
    <p class='mb-3'>
      I presented algebraic data type to enable type composition in the form of:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Sum (union)
        </li>
      
        <li>
          Product (record)
        </li>
      
    </ul>
  
    <p class='mb-3'>
      For example, the previous build type can also be defined as
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='language-none'>data build = Error | Success(log_url)</code></pre></div>
    <p class='mb-3'>
      For another side project, I presented different languages featuring a strong type system: PureScript, ELM and ReasonML. We picked ReasonML as the team was already familiar with React, and I wrote a blog post about this choice: <a href='https://www.softwarefactory-project.io/software-factory-resources-in-reason.html' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Software Factory Resources in Reason</a>.
    </p>
  <h3 id='benefits-4' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Benefits</h3>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Easier to review and maintain.
        </li>
      
        <li>
          Safer dependencies updates, most breaking changes are prevented by the compiler.
        </li>
      
    </ul>
  <h3 id='results-4' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Results</h3>
    <p class='mb-3'>
      Even though we applied this concept to a web application, using a strong type system was a very valuable experience. We could have used Python with some tricks, for example, by enabling the <code class='py-0.5 px-0.5 bg-gray-100'>strict</code> and <code class='py-0.5 px-0.5 bg-gray-100'>disallow-any-expr</code> options. This is impractical because Python is dearly missing support for tagged union and pattern matching.
    </p>
  
    <p class='mb-3'>
      To learn more about strong type systems, I recommend watching this talk by Jane Street: <a href='https://www.youtube.com/watch?v=kZ1P8cHN3pY' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Why Functional Programming Doesn’t Matter</a>.
    </p>
  <h2 id='introducing-programmable-configuration' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing programmable configuration</h2><h3 id='why-5' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Why</h3>
    <p class='mb-3'>
      Using a general purpose configuration DSL such as Dhall enables a functional approach to configuration management.
    </p>
  <h3 id='how-5' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>How</h3>
    <p class='mb-3'>
      Instead of using a data serialization language like JSON or YAML, I introduced the Dhall language to define our configurations.
    </p>
  
    <p class='mb-3'>
      In the <code class='py-0.5 px-0.5 bg-gray-100'>sf-infra</code> project, where we define our infrastructure, I showed how by using Dhall records we could define resources such as servers, volumes, and networks. Then I showed how we could use functions to transform those records into configurations such as the inventory or the monitoring, and how we can re-use those resources in other projects.
    </p>
  
    <p class='mb-3'>
      For the <code class='py-0.5 px-0.5 bg-gray-100'>zuul-operator</code> I wrote a Dhall function to convert the high level definition of a Zuul service into a collection of Kubernetes resources and ConfigMap.
    </p>
  <h3 id='benefits-5' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Benefits</h3>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Prevents runtime error, configuration is tested and valid by construction.
        </li>
      
        <li>
          Enables configuration refactoring.
        </li>
      
        <li>
          Fosters re-use through a powerful dependency and import system.
        </li>
      
    </ul>
  <h3 id='results-5' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Results</h3>
    <p class='mb-3'>
      Adopting a new syntax for configuration is a major difficulty. Though I showed how this functional language can be used for all our configuration needs, such as Kubernetes resources, container definitions, CI pipelines and Ansible playbooks.
    </p>
  <h2 id='introducing-knowledge-as-code' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Introducing knowledge as code</h2>
    <p class='mb-3'>
      As presented by Mikael Tönnberg in his <a href='https://carboncloud.com/2020/12/07/tech-knowledge-as-code/' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>Tech Knowledge-as-Code</a> article, I re-introduced type systems as a mean to manage software knowledge.
    </p>
  <h3 id='why-6' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Why</h3>
    <p class='mb-3'>
      To capture knowledge in a way that is understandable for both the computer and humans, now and in the future.
    </p>
  <h3 id='how-6' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>How</h3>
    <p class='mb-3'>
      Comparing with object’s names, documentations and tests, I showed how type annotation could capture the knowledge more effectively.
    </p>
  
    <p class='mb-3'>
      In the context of a couple of mob programming sessions, we added types to undocumented code, resulting in an insightful documentation. Then by increasing the type coverage, we were able to refine the initial knowledge of the code.
    </p>
  
    <p class='mb-3'>
      We used the <code class='py-0.5 px-0.5 bg-gray-100'>TypedDict</code> annotation to incrementally document the <code class='py-0.5 px-0.5 bg-gray-100'>distroinfo</code> library output.
    </p>
  <h3 id='benefits-6' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Benefits</h3>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Incremental, each modification adds knowledge.
        </li>
      
        <li>
          Mypy verifies the knowledge is correct.
        </li>
      
    </ul>
  <h3 id='results-6' class='mt-6 mb-2 text-3xl font-bold text-gray-700'>Results</h3>
    <p class='mb-3'>
      This concept is relatively easy to demonstrate and it yielded the most engagement from my team.
    </p>
  <h2 id='conclusion' class='mt-6 mb-4 text-4xl font-bold text-gray-700 border-b-2'>Conclusion</h2>
    <p class='mb-3'>
      Introducing new concepts can be an exhausting process. Most pragmatic engineers are likely to push back against new ideas, particularly when they induce friction. As an example, even early languages like Fortran were frowned upon by traditional binary bytecodes authors. Von Neuman himself was apparently getting <a href='http://www.columbia.edu/cu/computinghistory/index.html' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>angry</a> when his students used such language instead of writing the bytecode by hand.
    </p>
  
    <p class='mb-3'>
      FP vocabulary includes many unfamiliar words like curry, functor or cons. These words refer to the underlying concept and I think this is great to properly acknowledge what those things are. However, this causes additional friction and using more familiar words would have been a better choice to begin with.
    </p>
  
    <p class='mb-3'>
      Object oriented programming is still one of the most widely used paradigm, and even though it is fairly <a href='https://en.wikipedia.org/wiki/Object-oriented_programming#Criticism' class='text-blue-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>criticized</a>, it is the preferred paradigms in Python. Thus, embracing FP in Python may not be the best strategy and using a more appropriate language like OCaml or Haskell would be ideal.
    </p>
  
    <p class='mb-3'>
      At the end of the day, even if FP concepts are not applied directly, they can significantly improve non-FP development.
    </p>
  

  <!-- What goes in this file will appear below the note body-->
</article>
              <div class='flex flex-col lg:flex-row lg:space-x-2'>
                
                
              </div>
              
  <section class='flex flex-wrap items-end justify-center my-4 space-x-2 space-y-2 font-mono text-sm'>
    
      <!-- FIXME: The use of -/tags is wrong, because we should use routeUrl using Ema's encoder
        Perhaps Emanote should inject tagMetas with urls.
      -->
      <a title='Tag' class='px-1 bg-gray-100 rounded hover:bg-gray-50 hover:text-blue-500' href='-/tags/blog'>
        <!-- DoNotFormat -->
        #blog
        <!-- DoNotFormat -->
      </a>
    
  </section>
  <div class='flex items-center justify-center mt-2'>
    <a class='text-gray-300 hover:text-blue-600 text-sm' title='Edit this page on GitHub' href='https://github.com/TristanCacqueray/TristanCacqueray.github.io/edit/main/docs/blog/introducing-functional-programming-to-pythonistas.md'>
      <svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z'></path>
      </svg>
    </a>
    <p class='text-sm text-gray-600 mx-2'>
      This work is licensed under a <a class='hover:underline' href='http://creativecommons.org/licenses/by/4.0/'>Creative Commons Attribution 4.0 International License</a>
    </p>
  </div>


              <!-- What goes in this file will at the very end of the main div -->
            </main>
          </div>
        </div>
        <footer class='flex items-center justify-center mt-2 mb-8 space-x-4 text-center text-gray-800'>
  
  <div>
    <a href='' title='Go to Home page'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-blue-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6'></path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/all' title='View Index'>
      <svg class='w-6 h-6 hover:text-blue-700' fill='none' stroke='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4'>
        </path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/tags' title='View tags'>
      <svg class='w-6 h-6 hover:text-blue-700' fill='none' stroke='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z'>
        </path>
      </svg>
    </a>
  </div>
  <div>
    <a href='https://emanote.srid.ca' target='_blank' title='Generated by Emanote 1.2.0.0'>
      <img class='w-6 h-6 hover:text-blue-700' src='_emanote-static/emanote-logo.svg' />
    </a>
  </div>
</footer>

      </div>
    </div>
  
  <div id='stork-search-container' class='hidden fixed w-screen h-screen inset-0 backdrop-filter backdrop-blur-sm'>
  <div class='fixed w-screen h-screen inset-0' onclick='window.emanote.stork.toggleSearch()'></div>

  <div class='container mx-auto p-10 mt-10'>
    <div class='stork-wrapper-flat container mx-auto'>
      <input id='stork-search-input' data-stork='emanote-search' class='stork-input' placeholder='Search (Ctrl+K) ...' />
      <div data-stork='emanote-search-output' class='stork-output'></div>
    </div>
  </div>
</div>
  
    
  
</body>

</html>
